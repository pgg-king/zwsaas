import"./vue.4c5758a0.js";import{u as Z}from"./use-http.b69834f3.js";import{_ as $,h as q,t as G,i as J}from"./index.fc627453.js";import{r as _,w as R,aX as c,Z as s,$ as p,bd as x,aw as f,c as y,ax as b,u as m,_ as F,S as T,an as K,N as V,Q as j}from"./@vue.87afd1fa.js";import"./@babel.dd651e2b.js";import"./regenerator-runtime.8e24db72.js";import"./js-md5.3cdd41c4.js";import"./vue-router.9a2c52dc.js";import"./js-cookie.31874410.js";import"./ant-design-vue.e954adc4.js";import"./@ant-design.8c82b126.js";import"./@ctrl.fa7cbd46.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./dayjs.0743a87f.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./lodash.28c974ad.js";import"./spark-md5.2cc5764b.js";import"./@vueuse.67682d36.js";import"./vue-demi.24ed2461.js";import"./axios.e3200588.js";/* empty css                     */import"./sortablejs.412b554c.js";import"./clipboard.89482ba1.js";import"./markdown-it.39ce48f9.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.169105cf.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.52338b19.js";const W={class:"ex_scrollbar"},Y={key:0,class:"flex"},ee={style:{color:"#f50"}},te={class:"action"},ae={key:1,class:"flex"},oe={class:"action"},ne={name:"ExSidebar",inheritAttrs:!1},le=Object.assign(ne,{props:{hideAll:Boolean,hideAdd:Boolean,hideEdit:Boolean,hideDel:Boolean,hideFilter:Boolean,hideTools:Boolean,isTree:Boolean,tools:[Object,Boolean],value:[String,Number],sourceList:{type:Array,default:[]},default:{type:[String,Number],default:void 0},field:{type:String,default:"group_id"},selectedField:String,fieldNames:Object,url:String,params:{type:Object,default:{}}},emits:["update:value"],setup(l,{emit:v}){const o=l,{loading:de,http:C}=Z();let N,h=o.fieldNames.children,i=o.fieldNames.key,r=o.fieldNames.title;o.default!==void 0&&v("update:value",o.default);const S=_([o.default]),d=_(""),g=_(-1),B=_(o.sourceList.map(e=>e[i])),D=_(!0),O=_(w(o.sourceList)),E=(e,t)=>{for(let n=0;n<t.length;n++){const u=t[n];u[h]&&(u[h].some(A=>A[i]===e)?N=u[i]:E(e,u[h])&&(N=E(e,u[h])))}return N},L=e=>{B.value=e,D.value=!1};R(d,e=>{B.value=o.sourceList.map(t=>t[r].indexOf(e)>-1?E(t[i],O.value):null).filter((t,n,u)=>t&&u.indexOf(t)===n),d.value=e,D.value=!0});const M=(e,t)=>{if(t.selected){const n=e[0];o.selectedField?v("update:value",t.node[o.selectedField]):v("update:value",n)}else v("update:value",null)};function w(e){if(o.isTree&&(e=q(e,i,o.fieldNames.pid,h)),e.length==0&&(S.value=[""],v("update:value","")),!o.hideAll){const t={};t[i]="",t[r]=G("Sidebar.all"),t.ex_admin_render={name:"html",attribute:{"data-tag":"span"},content:{default:[t[r]]}},e.unshift(t)}return e}J.on(e=>{e=="Success"&&k()});function k(){C({url:o.url,method:"post",data:o.params}).then(e=>{O.value=w(e)})}function z(e){let t=e.node[i];t&&(g.value=t)}function I(){g.value=-1}return(e,t)=>{const n=c("render"),u=c("reload-outlined"),A=c("a-button"),P=c("a-space"),U=c("search-outlined"),H=c("a-input"),Q=c("a-tree"),X=c("a-card");return s(),p(X,{style:{height:"100%"},bodyStyle:{padding:"10px",height:"100%",display:"flex",flexDirection:"column"}},{default:x(()=>[l.hideTools?f("",!0):(s(),p(P,{key:0,style:{"margin-bottom":"10px"},size:10},{default:x(()=>[l.hideAdd?f("",!0):(s(),p(n,{key:0,data:l.tools.add},null,8,["data"])),y(A,{shape:"circle",size:"small",onClick:k},{icon:x(()=>[y(u)]),_:1})]),_:1})),l.hideFilter?f("",!0):(s(),p(H,{key:1,value:d.value,"onUpdate:value":t[0]||(t[0]=a=>d.value=a),style:{"margin-bottom":"8px"}},{prefix:x(()=>[y(U,{style:{color:"#c0c4cc"}})]),_:1},8,["value"])),b("div",W,[y(Q,{"expanded-keys":B.value,"tree-data":O.value,"auto-expand-parent":D.value,fieldNames:l.fieldNames,onExpand:L,onSelect:M,onMouseenter:z,onMouseleave:I,"block-node":"",selectedKeys:S.value,"onUpdate:selectedKeys":t[1]||(t[1]=a=>S.value=a)},{title:x(a=>[d.value&&a[m(r)]&&a[m(r)].indexOf(d.value)>-1?(s(),F("span",Y,[b("span",null,[T(K(a[m(r)].substr(0,a[m(r)].indexOf(d.value)))+" ",1),b("span",ee,K(d.value),1),T(" "+K(a[m(r)].substr(a[m(r)].indexOf(d.value)+d.value.length)),1)]),V(b("span",te,[l.hideEdit?f("",!0):(s(),p(n,{key:0,data:a.ex_admin_edit},null,8,["data"])),l.hideDel?f("",!0):(s(),p(n,{key:1,data:a.ex_admin_delete,onSuccess:k},null,8,["data"]))],512),[[j,g.value==a[m(i)]&&(a.ex_admin_edit||a.ex_admin_delete)]])])):(s(),F("span",ae,[y(n,{data:a.ex_admin_render},null,8,["data"]),V(b("span",oe,[l.hideEdit?f("",!0):(s(),p(n,{key:0,data:a.ex_admin_edit},null,8,["data"])),l.hideDel?f("",!0):(s(),p(n,{key:1,data:a.ex_admin_delete,onSuccess:k},null,8,["data"]))],512),[[j,g.value==a[m(i)]&&(a.ex_admin_edit||a.ex_admin_delete)]])]))]),_:1},8,["expanded-keys","tree-data","auto-expand-parent","fieldNames","selectedKeys"])])]),_:1})}}});var Ge=$(le,[["__scopeId","data-v-2e4721e3"]]);export{Ge as default};
